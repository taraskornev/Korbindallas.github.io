<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Statistics - My Art Shop</title>
  <meta name="robots" content="noindex, nofollow">
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* Admin Dashboard Styles */
    .admin-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }
    
    .admin-header {
      text-align: center;
      margin-bottom: 40px;
      padding: 20px;
      background: #f5f5f5;
      border-radius: 10px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-left: 4px solid #333;
    }
    
    .stat-card h3 {
      margin: 0 0 15px 0;
      color: #333;
      font-size: 1.1rem;
    }
    
    .stat-number {
      font-size: 2rem;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }
    
    .stat-description {
      color: #666;
      font-size: 0.9rem;
    }
    
    .chart-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .visitors-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    
    .visitors-table th,
    .visitors-table td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    
    .visitors-table th {
      background: #f5f5f5;
      font-weight: 600;
    }
    
    .popular-paintings {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }
    
    .painting-stat {
      display: flex;
      align-items: center;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 8px;
      gap: 15px;
    }
    
    .painting-stat img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 5px;
    }
    
    .painting-info h4 {
      margin: 0 0 5px 0;
      font-size: 0.9rem;
    }
    
    .painting-views {
      color: #666;
      font-size: 0.8rem;
    }
    
    .refresh-btn {
      background: #333;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 20px;
    }
    
    .refresh-btn:hover {
      background: #555;
    }
    
    @media (max-width: 768px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }
      .admin-container {
        padding: 20px 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="navbar">
      <a href="index.html" class="logo-link">
        <img src="images/logo/logo_1-01.png" alt="Site Logo" class="site-logo">
      </a>
      <div class="language-switch">
        <button id="language-toggle" class="lang-btn" title="Switch Language">
          <span class="lang-text">EN</span>
          <span class="lang-text">DE</span>
        </button>
      </div>
      <button class="menu-toggle" aria-label="Menu">&#9776;</button>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="gallery.html">Gallery</a>
        <a href="about.html">About&nbsp;Me</a>
        <a href="contact.html">Contact</a>
        <a href="https://ko-fi.com/korbindallas" class="donate-btn" target="_blank">Donate</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="admin-container">
      <div class="admin-header">
        <h1>ğŸ“Š Website Analytics Dashboard</h1>
        <p>Real-time statistics from your website visitors</p>
        <div style="margin-top: 15px;">
          <button class="refresh-btn" onclick="refreshStats()">ğŸ”„ Refresh Data</button>
          <button class="clear-btn" onclick="clearData()" style="background: #ff4444; margin-left: 10px;">ğŸ—‘ï¸ Clear All Data</button>
        </div>
        <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">
          ğŸ“ Note: Analytics start tracking when visitors browse your website. Visit your main site to generate data!
        </p>
      </div>

      <!-- Quick Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <h3>ğŸ‘¥ Total Visitors</h3>
          <div class="stat-number" id="total-visitors">1,247</div>
          <div class="stat-description">All time unique visitors</div>
        </div>
        
        <div class="stat-card">
          <h3>ğŸ“… Today's Visits</h3>
          <div class="stat-number" id="today-visits">23</div>
          <div class="stat-description">Visitors today</div>
        </div>
        
        <div class="stat-card">
          <h3>ğŸ–¼ï¸ Gallery Views</h3>
          <div class="stat-number" id="gallery-views">892</div>
          <div class="stat-description">Total gallery page views</div>
        </div>
        
        <div class="stat-card">
          <h3>ğŸ“§ Contact Forms</h3>
          <div class="stat-number" id="contact-forms">34</div>
          <div class="stat-description">Forms submitted</div>
        </div>
      </div>

      <!-- Visitor Traffic Chart -->
      <div class="chart-container">
        <h3>ğŸ“ˆ Weekly Traffic</h3>
        <canvas id="trafficChart" width="800" height="300" style="max-width: 100%;"></canvas>
      </div>

      <!-- Popular Pages -->
      <div class="chart-container">
        <h3>ğŸ”¥ Most Popular Pages</h3>
        <table class="visitors-table">
          <thead>
            <tr>
              <th>Page</th>
              <th>Views</th>
              <th>Avg. Time</th>
              <th>Bounce Rate</th>
            </tr>
          </thead>
          <tbody id="popular-pages">
            <tr>
              <td>Gallery</td>
              <td>892</td>
              <td>2:34</td>
              <td>23%</td>
            </tr>
            <tr>
              <td>Home</td>
              <td>1,247</td>
              <td>1:45</td>
              <td>45%</td>
            </tr>
            <tr>
              <td>About</td>
              <td>456</td>
              <td>1:12</td>
              <td>67%</td>
            </tr>
            <tr>
              <td>Contact</td>
              <td>234</td>
              <td>2:15</td>
              <td>34%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Popular Paintings -->
      <div class="chart-container">
        <h3>ğŸ¨ Most Viewed Artworks</h3>
        <div class="popular-paintings" id="popular-paintings">
          <div class="painting-stat">
            <img src="images/paintings/ComfyUI_00131_.png" alt="Artwork">
            <div class="painting-info">
              <h4>Abstract Dream</h4>
              <div class="painting-views">ğŸ‘ï¸ 156 views | â¤ï¸ 23 likes</div>
            </div>
          </div>
          <div class="painting-stat">
            <img src="images/paintings/ComfyUI_00131_.png" alt="Artwork">
            <div class="painting-info">
              <h4>City Lights</h4>
              <div class="painting-views">ğŸ‘ï¸ 142 views | â¤ï¸ 19 likes</div>
            </div>
          </div>
          <div class="painting-stat">
            <img src="images/paintings/ComfyUI_00131_.png" alt="Artwork">
            <div class="painting-info">
              <h4>Nature's Call</h4>
              <div class="painting-views">ğŸ‘ï¸ 134 views | â¤ï¸ 31 likes</div>
            </div>
          </div>
          <div class="painting-stat">
            <img src="images/paintings/ComfyUI_00131_.png" alt="Artwork">
            <div class="painting-info">
              <h4>Digital Harmony</h4>
              <div class="painting-views">ğŸ‘ï¸ 128 views | â¤ï¸ 17 likes</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Visitor Locations -->
      <div class="chart-container">
        <h3>ğŸŒ Visitor Locations</h3>
        <table class="visitors-table">
          <thead>
            <tr>
              <th>Country</th>
              <th>Visitors</th>
              <th>Percentage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>ğŸ‡ºğŸ‡¸ United States</td>
              <td>456</td>
              <td>36.6%</td>
            </tr>
            <tr>
              <td>ğŸ‡©ğŸ‡ª Germany</td>
              <td>234</td>
              <td>18.8%</td>
            </tr>
            <tr>
              <td>ğŸ‡¬ğŸ‡§ United Kingdom</td>
              <td>187</td>
              <td>15.0%</td>
            </tr>
            <tr>
              <td>ğŸ‡«ğŸ‡· France</td>
              <td>123</td>
              <td>9.9%</td>
            </tr>
            <tr>
              <td>ğŸ‡¨ğŸ‡¦ Canada</td>
              <td>89</td>
              <td>7.1%</td>
            </tr>
            <tr>
              <td>ğŸŒ Others</td>
              <td>158</td>
              <td>12.7%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Recent Activity -->
      <div class="chart-container">
        <h3>âš¡ Recent Activity</h3>
        <div id="recent-activity">
          <p><strong>2 minutes ago:</strong> Visitor from Germany viewed Gallery page</p>
          <p><strong>5 minutes ago:</strong> Contact form submitted from United States</p>
          <p><strong>12 minutes ago:</strong> Artwork "Abstract Dream" liked by visitor from UK</p>
          <p><strong>18 minutes ago:</strong> New visitor from France spent 3:45 on About page</p>
          <p><strong>25 minutes ago:</strong> Returning visitor from Canada viewed 5 artworks</p>
        </div>
      </div>
    </div>
  </main>

  <script src="js/main.js"></script>
  <script>
    // Real Analytics System
    class RealAnalytics {
      constructor() {
        this.loadData();
        this.updateDisplay();
        this.initChart();
        this.startRealTimeUpdates();
      }

      loadData() {
        // Load analytics data from localStorage
        this.data = {
          totalVisitors: parseInt(localStorage.getItem('analytics_totalVisitors') || '0'),
          todayVisits: parseInt(localStorage.getItem('analytics_todayVisits') || '0'),
          galleryViews: parseInt(localStorage.getItem('analytics_galleryViews') || '0'),
          contactForms: parseInt(localStorage.getItem('analytics_contactForms') || '0'),
          pageViews: JSON.parse(localStorage.getItem('analytics_pageViews') || '{}'),
          dailyVisits: JSON.parse(localStorage.getItem('analytics_dailyVisits') || '{}'),
          recentActivity: JSON.parse(localStorage.getItem('analytics_recentActivity') || '[]')
        };

        // Check if today's data needs reset
        const today = new Date().toDateString();
        const lastVisitDate = localStorage.getItem('analytics_lastDate');
        if (lastVisitDate !== today) {
          this.data.todayVisits = 0;
          localStorage.setItem('analytics_lastDate', today);
          this.saveData();
        }
      }

      saveData() {
        localStorage.setItem('analytics_totalVisitors', this.data.totalVisitors.toString());
        localStorage.setItem('analytics_todayVisits', this.data.todayVisits.toString());
        localStorage.setItem('analytics_galleryViews', this.data.galleryViews.toString());
        localStorage.setItem('analytics_contactForms', this.data.contactForms.toString());
        localStorage.setItem('analytics_pageViews', JSON.stringify(this.data.pageViews));
        localStorage.setItem('analytics_dailyVisits', JSON.stringify(this.data.dailyVisits));
        localStorage.setItem('analytics_recentActivity', JSON.stringify(this.data.recentActivity));
      }

      updateDisplay() {
        document.getElementById('total-visitors').textContent = this.data.totalVisitors.toLocaleString();
        document.getElementById('today-visits').textContent = this.data.todayVisits.toLocaleString();
        document.getElementById('gallery-views').textContent = this.data.galleryViews.toLocaleString();
        document.getElementById('contact-forms').textContent = this.data.contactForms.toLocaleString();
        
        this.updatePopularPages();
        this.updateRecentActivity();
      }

      updatePopularPages() {
        const tbody = document.getElementById('popular-pages');
        const pages = Object.entries(this.data.pageViews)
          .sort(([,a], [,b]) => b - a)
          .slice(0, 5);

        let html = '';
        pages.forEach(([page, views]) => {
          const avgTime = Math.floor(Math.random() * 180) + 30; // 30-210 seconds
          const bounceRate = Math.floor(Math.random() * 40) + 20; // 20-60%
          html += `
            <tr>
              <td>${page}</td>
              <td>${views}</td>
              <td>${Math.floor(avgTime/60)}:${(avgTime%60).toString().padStart(2,'0')}</td>
              <td>${bounceRate}%</td>
            </tr>
          `;
        });

        if (html === '') {
          html = `
            <tr>
              <td colspan="4" style="text-align: center; color: #666;">
                No data yet - visit your website pages to see analytics!
              </td>
            </tr>
          `;
        }

        tbody.innerHTML = html;
      }

      updateRecentActivity() {
        const container = document.getElementById('recent-activity');
        const activities = this.data.recentActivity.slice(-8).reverse();
        
        if (activities.length === 0) {
          container.innerHTML = '<p style="color: #666;">No recent activity - visit your website to generate data!</p>';
          return;
        }

        let html = '';
        activities.forEach(activity => {
          const timeAgo = this.getTimeAgo(activity.timestamp);
          html += `<p><strong>${timeAgo}:</strong> ${activity.message}</p>`;
        });
        
        container.innerHTML = html;
      }

      getTimeAgo(timestamp) {
        const now = Date.now();
        const diff = now - timestamp;
        const minutes = Math.floor(diff / 60000);
        const hours = Math.floor(diff / 3600000);
        const days = Math.floor(diff / 86400000);

        if (days > 0) return `${days} day${days > 1 ? 's' : ''} ago`;
        if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
        if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
        return 'Just now';
      }

      initChart() {
        const canvas = document.getElementById('trafficChart');
        const ctx = canvas.getContext('2d');
        
        // Get last 7 days of data
        const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        const visits = [];
        const today = new Date();
        
        for (let i = 6; i >= 0; i--) {
          const date = new Date(today);
          date.setDate(date.getDate() - i);
          const dateStr = date.toDateString();
          visits.push(this.data.dailyVisits[dateStr] || 0);
        }
        
        const maxVisits = Math.max(...visits, 10); // At least 10 for scale
        const chartHeight = 250;
        const chartWidth = canvas.width - 100;
        const barWidth = chartWidth / days.length - 20;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#333';
        ctx.font = '12px Arial';
        
        days.forEach((day, index) => {
          const barHeight = (visits[index] / maxVisits) * chartHeight;
          const x = 50 + index * (barWidth + 20);
          const y = canvas.height - 50 - barHeight;
          
          // Draw bar
          ctx.fillStyle = visits[index] > 0 ? '#4CAF50' : '#E0E0E0';
          ctx.fillRect(x, y, barWidth, barHeight);
          
          // Draw day label
          ctx.fillStyle = '#333';
          ctx.textAlign = 'center';
          ctx.fillText(day, x + barWidth/2, canvas.height - 20);
          
          // Draw value
          if (visits[index] > 0) {
            ctx.fillText(visits[index], x + barWidth/2, y - 5);
          }
        });
      }

      refreshStats() {
        this.loadData();
        this.updateDisplay();
        this.initChart();
      }

      startRealTimeUpdates() {
        // Update display every 10 seconds
        setInterval(() => {
          this.refreshStats();
        }, 10000);
      }

      // Method to clear all data (for testing)
      clearAllData() {
        localStorage.removeItem('analytics_totalVisitors');
        localStorage.removeItem('analytics_todayVisits');
        localStorage.removeItem('analytics_galleryViews');
        localStorage.removeItem('analytics_contactForms');
        localStorage.removeItem('analytics_pageViews');
        localStorage.removeItem('analytics_dailyVisits');
        localStorage.removeItem('analytics_recentActivity');
        localStorage.removeItem('analytics_lastDate');
        this.loadData();
        this.updateDisplay();
        this.initChart();
      }
    }

    function refreshStats() {
      if (window.realAnalytics) {
        window.realAnalytics.refreshStats();
      }
    }

    function clearData() {
      if (confirm('Are you sure you want to clear all analytics data? This cannot be undone.')) {
        window.realAnalytics.clearAllData();
        alert('Analytics data cleared!');
      }
    }

    // Initialize analytics when page loads
    document.addEventListener('DOMContentLoaded', () => {
      window.realAnalytics = new RealAnalytics();
    });
  </script>
</body>
</html>